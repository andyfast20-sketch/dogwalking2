{% extends 'base.html' %}
{% block title %}Website Settings{% endblock %}
{% block content %}
<section class="container" style="max-width:1000px">
  <h1 style="margin-bottom:10px">Website Content Editor</h1>
  <p style="margin-top:0;color:var(--muted)">Edit the services & pricing section displayed on the home page.</p>
  
  <!-- Maintenance Mode Toggle -->
  <div style="background:linear-gradient(180deg,rgba(245,158,11,.12),rgba(245,158,11,.06));border:2px solid rgba(245,158,11,.3);border-radius:16px;padding:24px;margin-top:24px;margin-bottom:32px">
    <div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:16px">
      <div>
        <h3 style="margin:0 0 8px;color:var(--accent-light);font-size:1.2rem">‚ö†Ô∏è Maintenance Mode</h3>
        <p style="margin:0;color:var(--text);font-size:.9rem">Display a warning banner at the top of all pages</p>
        <p style="margin:4px 0 0;color:var(--muted);font-size:.8rem">Message: "WEBSITE IS UNDER CONSTRUCTION - DO NOT PLACE ANY BOOKINGS"</p>
      </div>
      <form method="post" action="{{ url_for('admin_maintenance_toggle') }}" style="margin:0">
        <input type="hidden" name="enabled" value="{% if maintenance_mode_enabled %}false{% else %}true{% endif %}" />
        {% if maintenance_mode_enabled %}
        <button class="btn" type="submit" style="background:linear-gradient(135deg,#ef4444,#dc2626);color:#fff;padding:12px 24px;font-weight:700;white-space:nowrap">
          Turn OFF Maintenance Mode
        </button>
        {% else %}
        <button class="btn" type="submit" style="background:linear-gradient(135deg,var(--accent),var(--accent-light));color:#082621;padding:12px 24px;font-weight:700;white-space:nowrap">
          Turn ON Maintenance Mode
        </button>
        {% endif %}
      </form>
    </div>
    {% if maintenance_mode_enabled %}
    <div style="margin-top:16px;padding-top:16px;border-top:1px solid rgba(245,158,11,.2)">
      <div style="background:rgba(239,68,68,.15);border:1px solid rgba(239,68,68,.3);border-radius:10px;padding:12px;text-align:center">
        <strong style="color:#fca5a5;font-size:.9rem">üö® WARNING BANNER IS CURRENTLY ACTIVE ON ALL PAGES</strong>
      </div>
    </div>
    {% endif %}
  </div>
  
  <div style="margin-top:30px;display:flex;flex-direction:column;gap:24px">
    {% for service in services %}
    <div style="background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:24px">
      <form method="post" action="{{ url_for('admin_content_update', service_id=service.id) }}">
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px">
          <h3 style="margin:0;background:linear-gradient(135deg,var(--brand),var(--accent-light));-webkit-background-clip:text;background-clip:text;color:transparent">{{ service.title }}</h3>
          <button class="btn primary" type="submit">Save Changes</button>
        </div>
        
        <div style="display:grid;gap:16px">
          <label style="display:flex;flex-direction:column;gap:6px">
            <strong style="font-size:.9rem">Service Title</strong>
            <input type="text" name="title" value="{{ service.title }}" required
              style="padding:12px 14px;border-radius:12px;border:1px solid rgba(255,255,255,.16);background:rgba(255,255,255,.06);color:var(--text);font-size:1rem" />
          </label>
          
          <label style="display:flex;flex-direction:column;gap:6px">
            <strong style="font-size:.9rem">Price</strong>
            <input type="text" name="price" value="{{ service.price }}" placeholder="e.g., From ¬£14/hour"
              style="padding:12px 14px;border-radius:12px;border:1px solid rgba(255,255,255,.16);background:rgba(255,255,255,.06);color:var(--text);font-size:1rem" />
            <small style="color:var(--muted);font-size:.8rem">This appears at the top of the accordion panel</small>
          </label>
          
          <label style="display:flex;flex-direction:column;gap:6px">
            <strong style="font-size:.9rem">Description & Details</strong>
            <textarea name="content" rows="8" required
              style="padding:12px 14px;border-radius:12px;border:1px solid rgba(255,255,255,.16);background:rgba(255,255,255,.06);color:var(--text);font-size:1rem;font-family:inherit;line-height:1.6;resize:vertical">{{ service.content }}</textarea>
            <small style="color:var(--muted);font-size:.8rem">Use bullet points with "‚Ä¢" or "-" for lists. Each line will be displayed separately.</small>
          </label>
        </div>
        
        <div style="margin-top:12px;padding-top:16px;border-top:1px solid rgba(255,255,255,.08)">
          <details style="cursor:pointer">
            <summary style="font-weight:600;color:var(--accent-light);font-size:.9rem">Preview current content</summary>
            <div style="margin-top:12px;background:rgba(0,0,0,.2);border:1px solid rgba(255,255,255,.05);border-radius:10px;padding:16px">
              <p style="margin:0 0 8px;font-weight:700;color:var(--brand)">{{ service.price }}</p>
              {% set lines = service.content.split('\n') %}
              {% for line in lines %}
                {% if line.strip() %}
                  {% if line.strip().startswith('‚Ä¢') or line.strip().startswith('-') %}
                    <div style="margin-left:16px;font-size:.9rem;color:var(--text)">{{ line.strip() }}</div>
                  {% else %}
                    <p style="margin:8px 0;color:var(--text)">{{ line.strip() }}</p>
                  {% endif %}
                {% endif %}
              {% endfor %}
            </div>
          </details>
        </div>
      </form>
    </div>
    {% endfor %}
  </div>
</section>
{% endblock %}
